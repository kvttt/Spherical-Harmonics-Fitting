import numpy as np
from dipy.core.sphere import Sphere
from dipy.reconst.shm import sf_to_sh, sh_to_sf


odf = np.array([0.04697042, 0.04697042, 0.04697042, 0.04697042, 0.13688512,
                0.07368919, 0.07368919, 0.13688512, 0.03317791, 0.03317791,
                0.03317791, 0.03317791])

# odf = np.array([[odf, odf], [odf, odf]])

theta = np.array([1.57079633, 1.57079633, 1.57079633, 1.57079633, 0.55357436,
                  2.58801829, 0.55357436, 2.58801829, 1.01722197, 1.01722197,
                  2.12437069, 2.12437069])

phi = np.array([0.55357436,  2.58801829, -0.55357436, -2.58801829,  0.        ,
                0.        ,  3.14159265,  3.14159265,  1.57079633, -1.57079633,
                1.57079633, -1.57079633])

sphere = Sphere(theta=theta, phi=phi)

new_theta = np.array([1.57079633, 1.57079633, 1.57079633, 1.57079633, 0.55357436, 
                      2.58801829, 0.55357436, 2.58801829, 1.01722197, 1.01722197,
                      2.12437069, 2.12437069, 1.57079633, 1.57079633, 1.04719755,
                      1.04719755, 2.0943951 , 2.0943951 , 1.04719755, 1.04719755,
                      0.        , 2.0943951 , 2.0943951 , 3.14159265, 1.25663706,
                      1.25663706, 0.62831853, 0.62831853, 1.25663706, 1.25663706,
                      0.62831853, 0.62831853, 1.88495559, 1.88495559, 2.51327412,
                      2.51327412, 1.57079633, 1.88495559, 1.88495559, 2.51327412,
                      2.51327412, 1.57079633])

new_phi = np.array([0.55357436,  2.58801829, -0.55357436, -2.58801829,  0.        ,
                    0.        ,  3.14159265,  3.14159265,  1.57079633, -1.57079633,
                    1.57079633, -1.57079633,  0.        ,  3.14159265,  0.36486383,
                    -0.36486383,  0.36486383, -0.36486383,  2.77672883, -2.77672883,
                    1.57079633,  2.77672883, -2.77672883,  1.57079633,  1.01722197,
                    2.12437069,  1.01722197,  2.12437069, -1.01722197, -2.12437069,
                    -1.01722197, -2.12437069,  1.01722197,  2.12437069,  1.01722197,
                    2.12437069,  1.57079633, -1.01722197, -2.12437069, -1.01722197,
                    -2.12437069, -1.57079633])

new_sphere = Sphere(theta=new_theta, phi=new_phi)

sh = sf_to_sh(odf, sphere, 8)
sf = sh_to_sf(sh, new_sphere, 8)
